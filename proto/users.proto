syntax = "proto3";

package users;

option go_package = "github.com/anivanovle/users_proto/gen/users;users";

service UsersOrderManagement{
    rpc CreateOrder(CancelOrderRequest)returns(CreateOrderResponse);
    rpc Order(OrderRequest)returns(OrderResponse);
    rpc CancelOrder(CancelOrderRequest)returns(CancelOrderResponse);
    rpc OrderHistory(OrderHistoryRequest)returns(OrderHistoryResponse);
    rpc Rate(RateByUserRequest)returns(RateByUserResponse);

}

message Error{
    string code = 1;
    string message = 2;
}

message CreateOrderRequest{
    string from = 1;
    string to = 2;
    string userId = 3;
    string type = 4;
}


message CreateOrderResponse{

    oneof result{
       SuccessCreateOrder SuccessCreateOrder = 1;
       Error error = 2;

    }
}

message SuccessCreateOrder{
    string id = 1;
    string from = 2;
    string to = 3;
    string type = 4;
    string cost = 5;
    string distance = 6;
    string time = 7;
    string status = 8;
}





message Driver{
    string id = 1;
    string name = 2;
    string phone = 3;
    string driverComment = 4;
    float DriverRate = 5;
}

message User{
    string id = 1;
    string name = 2;
    string phone = 3;
    string userComment = 4;
    float userRate = 5;
}

message CancelParams{
    int64 canceled = 1;
    string cancelByRole = 2;

}

message OrderRequest{
    string orderId = 1;
}



message OrderResponse{
    oneof result{
       OrderResponseSuccess SuccessCreateOrder = 1;
       Error error = 2;

    }
}


message OrderResponseSuccess{
    string id = 1;
    string from = 2;
    string to = 3;
    string type = 4;
    string cost = 5;
    string distance = 6;
    string time = 7;
    string status = 8;
    int64 started = 9;
    int64 finished = 10;
    User user = 11;
    Driver driver = 12;
    CancelParams CancelParams = 13;

}






message CancelOrderRequest{
    string orderId = 1;
}

message CancelOrderResponse{
    oneof result{
       CancelOrderResponseSuccess CancelOrderResponseSuccess = 1;
       Error error = 2;

    }
}

message CancelOrderResponseSuccess{
    int64 canceled = 1;
}





message OrderHistoryRequest{
    string userId = 1; 
}

message OrderHistoryResponse{
    oneof result{
       OrderHistoryResponseSuccess OrderHistoryResponseSuccess = 1;
       Error error = 2;

    }
}

message OrderHistoryResponseSuccess{
    repeated OrderResponseSuccess orders = 1; 
}




message RateByUserRequest{
    string OrderId = 1;
    string Comment = 2;
}

message RateByUserResponse{
    Error error = 2;
}
